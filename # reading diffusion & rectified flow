# reading diffusion & rectified flow


## What is rectified flow?
Rectified flow is a method used to represent complex non-linear tragectories as linear by leveraging the use of ODEs. Its built of 4 steps
- Interpolation of points (flow matching)
- Velocity estimation across points. (v-prediction.)
- Definition of ODE dont forget its initial condition, $x_0$
- After we perform rectification, to interatively find the best linear fit. This is usaully termed as "reflow"

## What is diffusion?
Diffusion is a method used primarirly in image generation where high resolution images are iteratively from white gaussian noise. This is done by iterating on it on along a input vector set.


## How does rectified flow have to do with diffusion?
One issue of along with diffusion model is the assumption of linear tragectories across subsequent frames, however that's not truly the case. By computing the tragectories in its ODE, highly correlated linear tragectories can be greated. 

> is to make the new ODE path straighter, enabling the models to generate high-fidelity 
> images with fewer steps while retaining the flexibility of sampling with more inference 
> steps for further quality enhancemen 

Notes:
- Rectified flow is a subset of rectified diffusion: because rectified diffusion is a prediction of $x_0$ whilst general rectified flow is the prediction of $v_0$. that is rectified flow is easily determined from rectified diffusion 


## Classic Rectified Flow Matching


# NOTE FOR NEXT READ

That's it for tonight understand the math behind it the next time you read it.
That is revise on ODEs


# What is a Linear ODE
A linear differential equation is a differential equation where every term in the equation is built on a unit power of x irrespective of the order of derivatives applied. That is
the equation, only consists dz, d^2z, d^3z, .. d^nz but not x^2, dx^3, ... d^k x^n. or in other workds given an every term in an ODE should be
$$
\frac {d^k z^n} {dx^k}, k \memberof \mathbb{R}, n=1 and only 1
$$


### What is the order of an ODE

The order of an ODE is the maximum derivative within the equation. Given the expression above, the maximum `k` of any term, is the order of the ODE.

### Types of Linear ODE
- Homogeneous Linear ODE: each term either has the function itself or at least one derivative of it and there are no standalone function of the independent variable (usually written on the right side of the equation). In solving this, the function is substitued with $e^{\lambdax}$. This transforms the equation to a classic polynomial equation and using the zeros fo the equation, the function is easily computed from its equation.
However, you must note, polynomial equations, with repeated roots, flows a slightly unconvential paths. That is if there is a repeated root we use $e_\lambdax$ and $xe_\lambdax$: 


- Non Homogenous Linear ODE: In non-homogeneous, (on the right side of the equation usually), there is another contributing factor/function within it. In solving this. The equation is first homogenously calcaulated and then accounted for the "standalone function". 